{"version":3,"sources":["../../resolvers/discusion-pregunta.js"],"names":["Query","getListaIssuesByQuestions","parent","args","models","edgeDiscusionPreguntaArray","cursor","parseInt","Buffer","from","after","toString","limit","edgeDiscusionPreguntaInfoPromise","Promise","resolve","reject","edges","discusionPregunta","find","identificador","$gt","pregunta_ID","idPregunta","err","result","populate","on","push","res","node","endCursor","length","NaN","hasNextPage","cursorFinal","where","gt","count","pageInfo","hasnextPage","totalPagesPromise","listPaginateDiscusionPregunta","all","then","values","totalCount","getListaUsuariosAsignadoEstadoCorreccionPregunta","findById","idDiscusionPregunta","listaUsuarios","catch","error","Error","loadDiscusionPregunta","path","model","documento","loadListaDiscusionesGeneradasByPregunta","Pregunta","findOne","_id","discusiones","$slice","listadoDiscusionesPregunta","loadFirstDiscusionesPreguntasRecienCreadas","habilitada","sort","fecha_creacion","listaDiscusionesPregunta","loadListaCorreccionesByPreguntasCreadasEditadas","User","usuario","rolUsuario","roles","rol","$or","listadoCorreccionesPregunta","loadListaCorreccionesPreguntasByEstado","estado","loadlistaUsuariosCreadoCorreccionesPreguntas","distinct","$in","listaUsuariosDistintos","Mutation","nuevaDiscusionPregunta","titulo","numeroDiscusionesPregunta","discusion_pregunta","save","findByIdAndUpdate","$push","new","editarDiscusionPregunta","estado_correccion","asignacion","update","creador_correccion","documentoAfectado","n","eliminarDiscusionPregunta","correccionActualizada","editarMyDiscusionPreguntaByTitulo","correccionPregunta","correo","correoUsuario","$set","correccionPreguntaActualizada","editarMyDiscusionPreguntaByDescripcion","descripcion","aprobarEstadoMyDiscusionPregunta","documentoDiscusionPregunta","arrayFiltrado","findOneAndUpdate","Date","discusionAprovada","asignarEstadoACorrecciondePregunta","idUsuario","discusionActualizada","observacion"],"mappings":"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","file":"discusion-pregunta.js","sourcesContent":["/* eslint-disable no-unused-vars */\nexport default {\n\tQuery: {\n\t\tgetListaIssuesByQuestions: (parent, args, {models}) => {\n\t\t\tlet edgeDiscusionPreguntaArray = [];\n\t\t\tlet cursor = parseInt(Buffer.from(args.after, \"base64\").toString(\"ascii\"));\n\t\t\tif (!cursor){\n\t\t\t\tcursor = 0;\n\t\t\t}\n\t\t\tif(!args.limit){\n\t\t\t\targs.limit = 5;\n\t\t\t}\n\t\t\tlet edgeDiscusionPreguntaInfoPromise = new Promise((resolve, reject)=> {\n\t\t\t\tlet edges = models.discusionPregunta.find({identificador:{$gt:cursor},pregunta_ID: args.idPregunta}, (err, result) => {\n\t\t\t\t\tif(err){\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t}\n\t\t\t\t}).populate(\"creador_correccion\")\n\t\t\t\t\t.populate(\"etiquetas_correcciones\")\n\t\t\t\t\t.populate(\"estado_correccion.usuario_creador_estado\")\n\t\t\t\t\t.limit(args.limit).cursor();\n\n\t\t\t\tedges.on(\"data\", res => {\n\t\t\t\t\tedgeDiscusionPreguntaArray.push({\n\t\t\t\t\t\tcursor : Buffer.from((res.identificador).toString()).toString(\"base64\"),\n\t\t\t\t\t\tnode: res\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tedges.on(\"end\",()=> {\n\t\t\t\t\tlet endCursor = edgeDiscusionPreguntaArray.length > 0 ? edgeDiscusionPreguntaArray[edgeDiscusionPreguntaArray.length - 1].cursor:NaN;\n\t\t\t\t\tlet hasNextPage = new Promise((resolve, reject)=> {\n\t\t\t\t\t\tif (endCursor) {\n\t\t\t\t\t\t\tlet cursorFinal = parseInt(Buffer.from(endCursor,\"base64\").toString(\"ascii\"));\n\t\t\t\t\t\t\tmodels.discusionPregunta.where(\"identificador\").gt(cursorFinal).count({pregunta_ID: args.idPregunta},(err, count)=> {\n\t\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tcount > 0 ? resolve(true): resolve(false);\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tresolve({\n\t\t\t\t\t\tedges: edgeDiscusionPreguntaArray,\n\t\t\t\t\t\tpageInfo: {\n\t\t\t\t\t\t\tendCursor: endCursor,\n\t\t\t\t\t\t\thasnextPage: hasNextPage\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t\tlet totalPagesPromise = new Promise((resolve, reject) => {\n\t\t\t\tmodels.discusionPregunta.count({pregunta_ID: args.idPregunta},(err, count) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t}else {\n\t\t\t\t\t\tresolve(count);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tlet listPaginateDiscusionPregunta = Promise.all([edgeDiscusionPreguntaInfoPromise, totalPagesPromise]).then((values) => {\n\t\t\t\treturn {\n\t\t\t\t\tedges: values[0].edges,\n\t\t\t\t\ttotalCount: values[1],\n\t\t\t\t\tpageInfo:{\n\t\t\t\t\t\tendCursor: values[0].pageInfo.endCursor,\n\t\t\t\t\t\thasnextPage:values[0].pageInfo.hasnextPage\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t});\n\t\t\treturn listPaginateDiscusionPregunta;\n\t\t},\n\t\tgetListaUsuariosAsignadoEstadoCorreccionPregunta: (parent, args, {models}) => {\n\t\t\treturn models.discusionPregunta.findById(args.idDiscusionPregunta)\n\t\t\t\t.populate(\"estado_correccion.usuario_creador_estado\")\n\t\t\t\t.then(listaUsuarios => {\n\t\t\t\t\treturn listaUsuarios;\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif(error){\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t\tloadDiscusionPregunta: (parent, args, {models}) => {\n\t\t\treturn models.discusionPregunta.findById(args.idDiscusionPregunta)\n\t\t\t\t.populate(\"creador_correccion\")\n\t\t\t\t.populate(\"estado_correccion.usuario_creador_estado\")\n\t\t\t\t.populate(\"etiquetas_correcciones\")\n\t\t\t\t.populate({\n\t\t\t\t\tpath:\"pregunta_ID\",\n\t\t\t\t\tpopulate:{\n\t\t\t\t\t\tpath: \"areaconocimiento\",\n\t\t\t\t\t\tmodel: \"areas-conocimiento\"\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.populate({\n\t\t\t\t\tpath:\"pregunta_ID\",\n\t\t\t\t\tpopulate:{\n\t\t\t\t\t\tpath: \"usuario_ID\",\n\t\t\t\t\t\tmodel: \"usuario\"\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(documento => {\n\t\t\t\t\treturn documento;\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t\tloadListaDiscusionesGeneradasByPregunta: (parent, args, {models}) => {\n\t\t\treturn models.Pregunta.findOne({_id:args.idPregunta}, {discusiones:{$slice: args.limit}})\n\t\t\t\t.populate({\n\t\t\t\t\tpath: \"discusiones\",\n\t\t\t\t\tpopulate:{\n\t\t\t\t\t\tpath:\"creador_correccion\",\n\t\t\t\t\t\tmodel:\"usuario\"\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.populate({\n\t\t\t\t\tpath: \"discusiones\",\n\t\t\t\t\tpopulate:{\n\t\t\t\t\t\tpath:\"estado_correccion.usuario_creador_estado\",\n\t\t\t\t\t\tmodel:\"usuario\"\n\t\t\t\t\t}\n\n\t\t\t\t})\n\t\t\t\t.populate({\n\t\t\t\t\tpath: \"discusiones\",\n\t\t\t\t\tpopulate:{\n\t\t\t\t\t\tpath:\"etiquetas_correcciones\",\n\t\t\t\t\t\tmodel:\"etiqueta-correcciones\"\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.then(listadoDiscusionesPregunta => {\n\t\t\t\t\treturn listadoDiscusionesPregunta.discusiones;\n\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\n\t\t\t\t});\n\t\t},\n\t\tloadFirstDiscusionesPreguntasRecienCreadas: (parent, args, {models}) => {\n\t\t\treturn models.discusionPregunta.find({habilitada: true})\n\t\t\t\t.populate(\"creador_correccion\")\n\t\t\t\t.populate(\"pregunta_ID\")\n\t\t\t\t.populate(\"etiquetas_correcciones\")\n\t\t\t\t.sort({fecha_creacion: -1})\n\t\t\t\t.limit(5)\n\t\t\t\t.then(listaDiscusionesPregunta => {\n\t\t\t\t\treturn listaDiscusionesPregunta;\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error){\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t\tloadListaCorreccionesByPreguntasCreadasEditadas: (parent, args, {models})=> {\n\t\t\treturn models.User.findById(args.usuario, \"roles\")\n\t\t\t\t.then(rolUsuario => {\n\t\t\t\t\tif (rolUsuario.roles[0].rol === \"moderador\"){\n\t\t\t\t\t\treturn models.discusionPregunta.find({\"pregunta_ID\": args.idPregunta,\n\t\t\t\t\t\t\t\"estado_correccion.rol\": \"usuario\",\n\t\t\t\t\t\t\t$or: [\n\t\t\t\t\t\t\t\t{\"estado_correccion.asignacion\": \"creado\"},\n\t\t\t\t\t\t\t\t{\"estado_correccion.asignacion\": \"editado\"}\n\t\t\t\t\t\t\t]})\n\t\t\t\t\t\t\t.populate(\"etiquetas_correcciones\")\n\t\t\t\t\t\t\t.populate(\"creador_correccion\")\n\t\t\t\t\t\t\t.populate(\"pregunta_ID\")\n\t\t\t\t\t\t\t.populate(\"estado_correccion.usuario_creador_estado\")\n\t\t\t\t\t\t\t.limit(args.limit)\n\t\t\t\t\t\t\t.then(listadoCorreccionesPregunta => {\n\t\t\t\t\t\t\t\treturn listadoCorreccionesPregunta;\n\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthrow new Error(\"this users is not member committe, so you can't get this information\");\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(error => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t\tloadListaCorreccionesPreguntasByEstado: (parent, args, {models}) => {\n\t\t\tlet edgeDiscusionPreguntaArray = [];\n\t\t\tlet cursor = parseInt(Buffer.from(args.after, \"base64\").toString(\"ascii\"));\n\t\t\tif (!cursor){\n\t\t\t\tcursor = 0;\n\t\t\t}\n\t\t\tif(!args.limit){\n\t\t\t\targs.limit = 5;\n\t\t\t}\n\t\t\tlet edgeDiscusionPreguntaInfoPromise = new Promise((resolve, reject)=> {\n\t\t\t\tlet edges = models.discusionPregunta.find({identificador:{$gt:cursor},pregunta_ID: args.idPregunta,\n\t\t\t\t\t\"estado_correccion.asignacion\" : args.estado}, (err, result) => {\n\t\t\t\t\tif(err){\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t}\n\t\t\t\t}).populate(\"creador_correccion\")\n\t\t\t\t\t.populate(\"etiquetas_correcciones\")\n\t\t\t\t\t.populate(\"estado_correccion.usuario_creador_estado\")\n\t\t\t\t\t.limit(args.limit).cursor();\n\n\t\t\t\tedges.on(\"data\", res => {\n\t\t\t\t\tedgeDiscusionPreguntaArray.push({\n\t\t\t\t\t\tcursor : Buffer.from((res.identificador).toString()).toString(\"base64\"),\n\t\t\t\t\t\tnode: res\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tedges.on(\"end\",()=> {\n\t\t\t\t\tlet endCursor = edgeDiscusionPreguntaArray.length > 0 ? edgeDiscusionPreguntaArray[edgeDiscusionPreguntaArray.length - 1].cursor:NaN;\n\t\t\t\t\tlet hasNextPage = new Promise((resolve, reject)=> {\n\t\t\t\t\t\tif (endCursor) {\n\t\t\t\t\t\t\tlet cursorFinal = parseInt(Buffer.from(endCursor,\"base64\").toString(\"ascii\"));\n\t\t\t\t\t\t\tmodels.discusionPregunta.where(\"identificador\").gt(cursorFinal)\n\t\t\t\t\t\t\t\t.count({pregunta_ID: args.idPregunta,\"estado_correccion.asignacion\":args.estado},(err, count)=> {\n\t\t\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcount > 0 ? resolve(true): resolve(false);\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tresolve({\n\t\t\t\t\t\tedges: edgeDiscusionPreguntaArray,\n\t\t\t\t\t\tpageInfo: {\n\t\t\t\t\t\t\tendCursor: endCursor,\n\t\t\t\t\t\t\thasnextPage: hasNextPage\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t\tlet totalPagesPromise = new Promise((resolve, reject) => {\n\t\t\t\tmodels.discusionPregunta.count({pregunta_ID: args.idPregunta,\"estado_correccion.asignacion\":args.estado},(err, count) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t}else {\n\t\t\t\t\t\tresolve(count);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tlet listPaginateDiscusionPregunta = Promise.all([edgeDiscusionPreguntaInfoPromise, totalPagesPromise]).then((values) => {\n\t\t\t\treturn {\n\t\t\t\t\tedges: values[0].edges,\n\t\t\t\t\ttotalCount: values[1],\n\t\t\t\t\tpageInfo:{\n\t\t\t\t\t\tendCursor: values[0].pageInfo.endCursor,\n\t\t\t\t\t\thasnextPage:values[0].pageInfo.hasnextPage\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t});\n\t\t\treturn listPaginateDiscusionPregunta;\n\t\t},\n\t\tloadlistaUsuariosCreadoCorreccionesPreguntas: (parent, args, {models})=> {\n\t\t\treturn models.discusionPregunta.distinct(\"creador_correccion\",{\"pregunta_ID\": args.idPregunta})\n\t\t\t\t.then(listaUsuariosDistintos => {\n\t\t\t\t\treturn models.User.find({\"_id\":{$in:listaUsuariosDistintos}})\n\t\t\t\t\t\t.then(listaUsuarios => {\n\t\t\t\t\t\t\treturn listaUsuarios;\n\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\tif (error){\n\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error){\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\t},\n\tMutation: {\n\t\tnuevaDiscusionPregunta : (parent, args, {models}) => {\n\t\t\treturn models.discusionPregunta.findOne({titulo: args.discusionPregunta.titulo})\n\t\t\t\t.then(discusionPregunta => {\n\t\t\t\t\tif(discusionPregunta) {\n\t\t\t\t\t\tthrow new Error(\"you already create this question, you can't create the same correction two times\");\n\t\t\t\t\t}else{\n\t\t\t\t\t\treturn models.discusionPregunta.count()\n\t\t\t\t\t\t\t.then(numeroDiscusionesPregunta => {\n\t\t\t\t\t\t\t\tif (numeroDiscusionesPregunta){\n\t\t\t\t\t\t\t\t\targs.discusionPregunta.identificador = numeroDiscusionesPregunta + 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst discusion_pregunta = new models.discusionPregunta(args.discusionPregunta);\n\t\t\t\t\t\t\t\treturn discusion_pregunta.save()\n\t\t\t\t\t\t\t\t\t.then(documento => {\n\t\t\t\t\t\t\t\t\t\treturn models.Pregunta.findByIdAndUpdate(args.discusionPregunta.pregunta_ID,\n\t\t\t\t\t\t\t\t\t\t\t{$push:{discusiones:documento}},\n\t\t\t\t\t\t\t\t\t\t\t{new: true})\n\t\t\t\t\t\t\t\t\t\t\t.then(()=> {\n\t\t\t\t\t\t\t\t\t\t\t\treturn documento;\n\n\t\t\t\t\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t}\n\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t},\n\t\teditarDiscusionPregunta: (parent, args, {models}) => {\n\t\t\treturn models.discusionPregunta.findOne({\"_id\": args.idDiscusionPregunta, \"estado_correccion.rol\": \"usuario\"},{\"estado_correccion.$\":1})\n\t\t\t\t.then(discusionPregunta => {\n\t\t\t\t\tif (discusionPregunta.estado_correccion[0].asignacion === \"pendiente\"){\n\t\t\t\t\t\tthrow new Error(\"the question creator's is editing the content, thanks to your issues,\" +\n\t\t\t\t\t\t\t\"you can not make change to a issues, in state pending\");\n\t\t\t\t\t}else if (discusionPregunta.estado_correccion[0].asignacion === \"cerrado\") {\n\t\t\t\t\t\tthrow new Error(\"the issues was reject by a committee member, so you must create a new one issues\");\n\t\t\t\t\t}else if (discusionPregunta.estado_correccion[0].asignacion === \"resuelto\") {\n\t\t\t\t\t\tthrow new Error(\"the creator this issues already accept the change of the question creator, so you decided \" +\n\t\t\t\t\t\t\t\"marked this issues like solved!, you should create other issues\");\n\t\t\t\t\t}else {\n\t\t\t\t\t\treturn models.discusionPregunta.update({_id: args.idDiscusionPregunta, creador_correccion: args.discusionPregunta.creador_correccion},\n\t\t\t\t\t\t\targs.discusionPregunta)\n\t\t\t\t\t\t\t.then(documentoAfectado => {\n\t\t\t\t\t\t\t\tif (documentoAfectado.n === 1){\n\t\t\t\t\t\t\t\t\treturn true;\n\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tthrow new Error(\"This user can't edit this question, because he is not the owner\");\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\tif (error){\n\t\t\t\t\t\t\t\t\tthrow new  Error(error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error){\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\n\t\t},\n\t\teliminarDiscusionPregunta: (parent, args, {models}) => {\n\t\t\treturn models.discusionPregunta.findOne({\"_id\": args.idDiscusionPregunta, \"estado_correccion.rol\": \"usuario\"},{\"estado_correccion.$\":1})\n\t\t\t\t.then(discusionPregunta => {\n\t\t\t\t\tif (discusionPregunta.estado_correccion[0].asignacion === \"pendiente\"){\n\t\t\t\t\t\tthrow new Error(\"the question creator's is editing the content, thanks to your issues,\" +\n\t\t\t\t\t\t\t\"you can not delete this issues, in state pending\");\n\t\t\t\t\t}else {\n\t\t\t\t\t\treturn models.discusionPregunta.update({_id: args.idDiscusionPregunta,creador_correccion: args.creador_correccion},\n\t\t\t\t\t\t\t{habilitada: false})\n\t\t\t\t\t\t\t.then(correccionActualizada => {\n\t\t\t\t\t\t\t\tif (correccionActualizada.n === 1) {\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tthrow new Error(\"This user can't edit this question, because he is not the owner\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\tif (error){\n\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error){\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t},\n\t\teditarMyDiscusionPreguntaByTitulo: (parent, args, {models}) => {\n\t\t\treturn models.discusionPregunta.findOne({\"_id\": args.idDiscusionPregunta, \"estado_correccion.rol\": \"usuario\"},\n\t\t\t\t{\"estado_correccion.$\":1})\n\t\t\t\t.then(discusionPregunta => {\n\t\t\t\t\tif (discusionPregunta.estado_correccion[0].asignacion === \"pendiente\"){\n\t\t\t\t\t\tthrow new Error(\"the question creator's is editing the content, thanks to your issues,\" +\n\t\t\t\t\t\t\t\"you can not make change to a issues, in state pending\");\n\t\t\t\t\t}else if (discusionPregunta.estado_correccion[0].asignacion === \"cerrado\") {\n\t\t\t\t\t\tthrow new Error(\"the issues was reject by a committee member, so you must create a new one issues\");\n\t\t\t\t\t}else if (discusionPregunta.estado_correccion[0].asignacion === \"resuelto\") {\n\t\t\t\t\t\tthrow new Error(\"you already accept the change of the question creator, so you decided \" +\n\t\t\t\t\t\t\t\"marked this issues like solved!, you should create other issues\");\n\t\t\t\t\t}else{\n\t\t\t\t\t\treturn models.discusionPregunta.findById(args.idDiscusionPregunta, \"creador_correccion\")\n\t\t\t\t\t\t\t.populate(\"creador_correccion\")\n\t\t\t\t\t\t\t.then(correccionPregunta => {\n\t\t\t\t\t\t\t\tif (correccionPregunta.creador_correccion.correo === args.correoUsuario) {\n\t\t\t\t\t\t\t\t\treturn models.discusionPregunta.findByIdAndUpdate(args.idDiscusionPregunta,\n\t\t\t\t\t\t\t\t\t\t{$set: {titulo: args.titulo}},{new: true})\n\t\t\t\t\t\t\t\t\t\t.then(correccionPreguntaActualizada => {\n\t\t\t\t\t\t\t\t\t\t\treturn correccionPreguntaActualizada;\n\t\t\t\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\tthrow new Error(\"this question issue you can not edit, because you are not the owner\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(error => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t\teditarMyDiscusionPreguntaByDescripcion: (parent, args, {models}) => {\n\t\t\treturn models.discusionPregunta.findOne({\"_id\": args.idDiscusionPregunta, \"estado_correccion.rol\": \"usuario\"},\n\t\t\t\t{\"estado_correccion.$\":1})\n\t\t\t\t.then(discusionPregunta => {\n\t\t\t\t\tif (discusionPregunta.estado_correccion[0].asignacion === \"pendiente\"){\n\t\t\t\t\t\tthrow new Error(\"the question creator's is editing the content, thanks to your issues,\" +\n\t\t\t\t\t\t\t\"you can not make change to a issues, in state pending\");\n\t\t\t\t\t}else if (discusionPregunta.estado_correccion[0].asignacion === \"cerrado\") {\n\t\t\t\t\t\tthrow new Error(\"the issues was reject by a committee member, so you must create a new one issues\");\n\t\t\t\t\t}else if (discusionPregunta.estado_correccion[0].asignacion === \"resuelto\") {\n\t\t\t\t\t\tthrow new Error(\"you already accept the change of the question creator, so you decided \" +\n\t\t\t\t\t\t\t\"marked this issues like solved!, you should create other issues\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn models.discusionPregunta.findById(args.idDiscusionPregunta, \"creador_correccion\")\n\t\t\t\t\t\t\t.populate(\"creador_correccion\")\n\t\t\t\t\t\t\t.then(correccionPregunta => {\n\t\t\t\t\t\t\t\tif (correccionPregunta.creador_correccion.correo === args.correoUsuario) {\n\t\t\t\t\t\t\t\t\treturn models.discusionPregunta.findByIdAndUpdate(args.idDiscusionPregunta,\n\t\t\t\t\t\t\t\t\t\t{$set: {descripcion: args.descripcion}},{new: true})\n\t\t\t\t\t\t\t\t\t\t.then(correccionPreguntaActualizada => {\n\t\t\t\t\t\t\t\t\t\t\treturn correccionPreguntaActualizada;\n\t\t\t\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\tthrow new Error(\"this question issue you can not edit, because you are not the owner\");\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t\taprobarEstadoMyDiscusionPregunta: (parent, args, {models}) => {\n\t\t\treturn models.discusionPregunta.findById(args.idDiscusionPregunta)\n\t\t\t\t.then(documentoDiscusionPregunta => {\n\t\t\t\t\tif (documentoDiscusionPregunta.habilitada){\n\t\t\t\t\t\treturn models.discusionPregunta.findOne({\"_id\": args.idDiscusionPregunta,\n\t\t\t\t\t\t\t\"estado_correccion.usuario_creador_estado\": documentoDiscusionPregunta.creador_correccion},\n\t\t\t\t\t\t{\"estado_correccion.$\":1})\n\t\t\t\t\t\t\t.then(arrayFiltrado => {\n\t\t\t\t\t\t\t\tif(arrayFiltrado.estado_correccion[0][\"asignacion\"]!== \"cerrado\" && arrayFiltrado.estado_correccion[0][\"asignacion\"]!== \"resuelto\"){\n\t\t\t\t\t\t\t\t\treturn models.discusionPregunta.findOneAndUpdate({\"_id\": args.idDiscusionPregunta,\n\t\t\t\t\t\t\t\t\t\t\"estado_correccion.usuario_creador_estado\": documentoDiscusionPregunta.creador_correccion},\n\t\t\t\t\t\t\t\t\t{$set: {\"estado_correccion.$.asignacion\":\"resuelto\",\n\t\t\t\t\t\t\t\t\t\t\"estado_correccion.$.observacion\":\"el usuario ha cerrado esta discusion,\" +\n\t\t\t\t\t\t\t\t\t\t\t\t\"debido que el creador de la pregunta, realizo los cambios respectivos\",\n\t\t\t\t\t\t\t\t\t\t\"fecha_cierre\": new Date()}},\n\t\t\t\t\t\t\t\t\t{new: true}).then(discusionAprovada => {\n\t\t\t\t\t\t\t\t\t\treturn discusionAprovada;\n\t\t\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tthrow new Error(\"you can't approved a issues questions, that already is closed or solved!\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthrow new Error(\"you can't approved a question issues, that you had closed!\");\n\t\t\t\t\t}\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t\tasignarEstadoACorrecciondePregunta: (parent, args, {models}) => {\n\t\t\treturn models.discusionPregunta.findOne({\"_id\": args.idDiscusionPregunta},\"creador_correccion, estado_correccion\")\n\t\t\t\t.populate(\"creador_correccion\")\n\t\t\t\t.then(usuario => {\n\t\t\t\t\tif(usuario.creador_correccion._id == args.idUsuario){\n\t\t\t\t\t\tthrow new Error(\"the owner of this issues, can't approved or reject this!!\");\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif (usuario.estado_correccion[0].asignacion === \"pendiente\" || usuario.estado_correccion.asignacion === \"cerrado\"){\n\t\t\t\t\t\t\tthrow new Error(\"this issues was already assigned by a committe member, you can't change this!\");\n\t\t\t\t\t\t}else if(usuario.estado_correccion[0].asignacion === \"resuelto\") {\n\t\t\t\t\t\t\tthrow new Error(\"this issues was already marked like solved, by the owner this content\");\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tif (args.estado === \"rechazado\"){\n\t\t\t\t\t\t\t\treturn models.discusionPregunta.findOneAndUpdate({\"_id\":args.idDiscusionPregunta,\"estado_correccion.rol\":\"usuario\"},\n\t\t\t\t\t\t\t\t\t{$set: {\"estado_correccion.$.asignacion\": \"cerrado\",\"fecha_cierre\": new Date()}},{new: true})\n\t\t\t\t\t\t\t\t\t.then(discusionActualizada => {\n\t\t\t\t\t\t\t\t\t\treturn models.discusionPregunta.findOneAndUpdate({\"_id\":discusionActualizada._id},{$push:{\"estado_correccion\":{\"observacion\":args.observacion,\"usuario_creador_estado\": args.idUsuario,\n\t\t\t\t\t\t\t\t\t\t\t\"rol\":\"moderador\",\"asignacion\":\"rechazado\"}}},{new: true})\n\t\t\t\t\t\t\t\t\t\t\t.populate(\"estado_correccion.usuario_creador_estado\")\n\t\t\t\t\t\t\t\t\t\t\t.then(correccionActualizada => {\n\t\t\t\t\t\t\t\t\t\t\t\treturn correccionActualizada;\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\t\t\tif (error){\n\t\t\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}else if(args.estado === \"aceptado\"){\n\t\t\t\t\t\t\t\treturn models.discusionPregunta.findOneAndUpdate({\"_id\":args.idDiscusionPregunta,\"estado_correccion.rol\":\"usuario\"},\n\t\t\t\t\t\t\t\t\t{$set: {\"estado_correccion.$.asignacion\": \"pendiente\"}},{new: true})\n\t\t\t\t\t\t\t\t\t.then(discusionActualizada => {\n\t\t\t\t\t\t\t\t\t\treturn models.discusionPregunta.findOneAndUpdate({\"_id\":discusionActualizada._id},{$push:{\"estado_correccion\":{\"observacion\":args.observacion,\"usuario_creador_estado\": args.idUsuario,\n\t\t\t\t\t\t\t\t\t\t\t\"rol\":\"moderador\",\"asignacion\":\"aceptado\"}}},{new: true})\n\t\t\t\t\t\t\t\t\t\t\t.populate(\"estado_correccion.usuario_creador_estado\")\n\t\t\t\t\t\t\t\t\t\t\t.populate(\"pregunta_ID\")\n\t\t\t\t\t\t\t\t\t\t\t.then(correccionActualizada => {\n\t\t\t\t\t\t\t\t\t\t\t\tif (discusionActualizada.pregunta_ID.estado === \"estable\"){\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn models.Pregunta.findByIdAndUpdate(discusionActualizada.pregunta_ID._id,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{$set:{estado: \"revision\"}},{new: true})\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn correccionActualizada;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(error){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\treturn correccionActualizada;\n\t\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\t\t\tif (error){\n\t\t\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error){\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\t}\n\n};"]}