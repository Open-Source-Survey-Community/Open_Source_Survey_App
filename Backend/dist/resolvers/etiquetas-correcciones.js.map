{"version":3,"sources":["../../resolvers/etiquetas-correcciones.js"],"names":["Query","listadoEtiquetasCorrecciones","parent","args","models","idioma","etiquetaCorrecciones","find","populate","then","documentoEtiquetaCorrecciones","catch","error","Error","filtrarEtiquetasCorrecciones","etiqueta","RegExp","caracter","limit","documento","Mutation","crearNuevaEtiquetaCorrecciones","findOne","$regex","save","editarEtiquetaCorrecciontoPregunta","findById","idEtiquetaCorreccion","documentoEtiquetaCorreccion","usuariopropietario","correo","correoUsuario","discusionPregunta","count","etiquetas_correcciones","habilitada","numeroDiscusionesPreguntas","findByIdAndUpdate","$set","color","descripcion","new","etiquetaCorreccionEditada","eliminarEtiquetaCorreccionPregunta","findByIdAndRemove"],"mappings":"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","file":"etiquetas-correcciones.js","sourcesContent":["export default {\n\tQuery: {\n\t\tlistadoEtiquetasCorrecciones: (parent, args, {models}) =>{\n\t\t\tif (args.idioma) {\n\t\t\t\treturn models.etiquetaCorrecciones.find({idioma: args.idioma}).populate(\"usuariopropietario\")\n\t\t\t\t\t.then(documentoEtiquetaCorrecciones => {\n\t\t\t\t\t\treturn documentoEtiquetaCorrecciones;\n\n\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t}else {\n\t\t\t\tthrow new Error(\"is neccessary a lenguage to filter tags\");\n\n\t\t\t}\n\t\t},\n\t\tfiltrarEtiquetasCorrecciones: (parent, args, {models}) => {\n\t\t\treturn models.etiquetaCorrecciones.find({idioma: args.idioma, etiqueta: new RegExp(args.caracter, \"i\")})\n\t\t\t\t.populate(\"usuariopropietario\")\n\t\t\t\t.limit(10)\n\t\t\t\t.then(documento => {\n\t\t\t\t\treturn documento;\n\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t}\n\n\n\t},\n\tMutation : {\n\t\tcrearNuevaEtiquetaCorrecciones: (parent, args, {models}) => {\n\t\t\treturn models.etiquetaCorrecciones.findOne({etiqueta: {$regex: new RegExp(args.etiqueta.etiqueta, \"i\")}})\n\t\t\t\t.then(etiqueta => {\n\t\t\t\t\tif (etiqueta) {\n\t\t\t\t\t\tthrow new Error(\"this tag already exist in the collection\");\n\t\t\t\t\t}else{\n\t\t\t\t\t\tconst etiquetaCorrecciones = new models.etiquetaCorrecciones(args.etiqueta);\n\t\t\t\t\t\treturn etiquetaCorrecciones.save()\n\t\t\t\t\t\t\t.then(documento => {\n\t\t\t\t\t\t\t\treturn documento;\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error){\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t\teditarEtiquetaCorrecciontoPregunta: (parent, args, {models}) => {\n\t\t\treturn models.etiquetaCorrecciones.findById(args.idEtiquetaCorreccion,\"usuariopropietario\")\n\t\t\t\t.populate(\"usuariopropietario\")\n\t\t\t\t.then(documentoEtiquetaCorreccion => {\n\t\t\t\t\tif(documentoEtiquetaCorreccion.usuariopropietario.correo === args.correoUsuario){\n\t\t\t\t\t\treturn models.discusionPregunta.count({etiquetas_correcciones: args.idEtiquetaCorreccion,\n\t\t\t\t\t\t\thabilitada: true})\n\t\t\t\t\t\t\t.then(numeroDiscusionesPreguntas => {\n\t\t\t\t\t\t\t\tif (numeroDiscusionesPreguntas > 0) {\n\t\t\t\t\t\t\t\t\tthrow new Error(\"you can't edit this tag, because other users are using the same tag\");\n\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\treturn models.etiquetaCorrecciones.findByIdAndUpdate(args.idEtiquetaCorreccion,\n\t\t\t\t\t\t\t\t\t\t{$set:{color: args.color, descripcion: args.descripcion, etiqueta: args.etiqueta}},\n\t\t\t\t\t\t\t\t\t\t{new: true})\n\t\t\t\t\t\t\t\t\t\t.then(etiquetaCorreccionEditada => {\n\t\t\t\t\t\t\t\t\t\t\treturn etiquetaCorreccionEditada;\n\t\t\t\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\tif (error){\n\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthrow new Error(\"you can't edit this tag because you are not the owner\");\n\t\t\t\t\t}\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t\teliminarEtiquetaCorreccionPregunta : (parent, args, {models}) => {\n\t\t\treturn models.etiquetaCorrecciones.findById(args.idEtiquetaCorreccion,\"usuariopropietario\")\n\t\t\t\t.populate(\"usuariopropietario\")\n\t\t\t\t.then(documentoEtiquetaCorreccion => {\n\t\t\t\t\tif(documentoEtiquetaCorreccion.usuariopropietario.correo === args.correoUsuario){\n\t\t\t\t\t\treturn models.discusionPregunta.count({etiquetas_correcciones: args.idEtiquetaCorreccion,\n\t\t\t\t\t\t\thabilitada: true})\n\t\t\t\t\t\t\t.then(numeroDiscusionesPreguntas => {\n\t\t\t\t\t\t\t\tif (numeroDiscusionesPreguntas > 0) {\n\t\t\t\t\t\t\t\t\tthrow new Error(\"you can't edit this tag, because other users are using the same tag\");\n\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\treturn models.etiquetaCorrecciones.findByIdAndRemove(args.idEtiquetaCorreccion)\n\t\t\t\t\t\t\t\t\t\t.then(etiquetaCorreccionEditada => {\n\t\t\t\t\t\t\t\t\t\t\treturn etiquetaCorreccionEditada;\n\t\t\t\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\tif (error){\n\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthrow new Error(\"you can't edit this tag because you are not the owner\");\n\t\t\t\t\t}\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t}\n\n\t}\n\n};"]}