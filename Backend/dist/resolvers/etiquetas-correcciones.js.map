{"version":3,"sources":["../../resolvers/etiquetas-correcciones.js"],"names":["Query","listadoEtiquetasCorrecciones","parent","args","models","idioma","etiquetaCorrecciones","find","populate","then","documentoEtiquetaCorrecciones","catch","error","Error","Mutation","crearNuevaEtiquetaCorrecciones","findOne","etiqueta","$regex","RegExp","save","documento","editarEtiquetaCorrecciontoPregunta","findById","idEtiquetaCorreccion","documentoEtiquetaCorreccion","usuariopropietario","correo","correoUsuario","discusionPregunta","count","etiquetas_correcciones","habilitada","numeroDiscusionesPreguntas","findByIdAndUpdate","$set","color","descripcion","new","etiquetaCorreccionEditada","eliminarEtiquetaCorreccionPregunta","findByIdAndRemove"],"mappings":"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","file":"etiquetas-correcciones.js","sourcesContent":["export default {\n\tQuery: {\n\t\tlistadoEtiquetasCorrecciones: (parent, args, {models}) =>{\n\t\t\tif (args.idioma) {\n\t\t\t\treturn models.etiquetaCorrecciones.find({idioma: args.idioma}).populate(\"usuariopropietario\")\n\t\t\t\t\t.then(documentoEtiquetaCorrecciones => {\n\t\t\t\t\t\treturn documentoEtiquetaCorrecciones;\n\n\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t}else {\n\t\t\t\tthrow new Error(\"is neccessary a lenguage to filter tags\");\n\n\t\t\t}\n\t\t}\n\n\n\t},\n\tMutation : {\n\t\tcrearNuevaEtiquetaCorrecciones: (parent, args, {models}) => {\n\t\t\treturn models.etiquetaCorrecciones.findOne({etiqueta: {$regex: new RegExp(args.etiqueta.etiqueta, \"i\")}})\n\t\t\t\t.then(etiqueta => {\n\t\t\t\t\tif (etiqueta) {\n\t\t\t\t\t\tthrow new Error(\"this tag already exist in the collection\");\n\t\t\t\t\t}else{\n\t\t\t\t\t\tconst etiquetaCorrecciones = new models.etiquetaCorrecciones(args.etiqueta);\n\t\t\t\t\t\treturn etiquetaCorrecciones.save()\n\t\t\t\t\t\t\t.then(documento => {\n\t\t\t\t\t\t\t\treturn documento;\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error){\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t\teditarEtiquetaCorrecciontoPregunta: (parent, args, {models}) => {\n\t\t\treturn models.etiquetaCorrecciones.findById(args.idEtiquetaCorreccion,\"usuariopropietario\")\n\t\t\t\t.populate(\"usuariopropietario\")\n\t\t\t\t.then(documentoEtiquetaCorreccion => {\n\t\t\t\t\tif(documentoEtiquetaCorreccion.usuariopropietario.correo === args.correoUsuario){\n\t\t\t\t\t\treturn models.discusionPregunta.count({etiquetas_correcciones: args.idEtiquetaCorreccion,\n\t\t\t\t\t\t\thabilitada: true})\n\t\t\t\t\t\t\t.then(numeroDiscusionesPreguntas => {\n\t\t\t\t\t\t\t\tif (numeroDiscusionesPreguntas > 0) {\n\t\t\t\t\t\t\t\t\tthrow new Error(\"you can't edit this tag, because other users are using the same tag\");\n\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\treturn models.etiquetaCorrecciones.findByIdAndUpdate(args.idEtiquetaCorreccion,\n\t\t\t\t\t\t\t\t\t\t{$set:{color: args.color, descripcion: args.descripcion, etiqueta: args.etiqueta}},\n\t\t\t\t\t\t\t\t\t\t{new: true})\n\t\t\t\t\t\t\t\t\t\t.then(etiquetaCorreccionEditada => {\n\t\t\t\t\t\t\t\t\t\t\treturn etiquetaCorreccionEditada;\n\t\t\t\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\tif (error){\n\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthrow new Error(\"you can't edit this tag because you are not the owner\");\n\t\t\t\t\t}\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t\teliminarEtiquetaCorreccionPregunta : (parent, args, {models}) => {\n\t\t\treturn models.etiquetaCorrecciones.findById(args.idEtiquetaCorreccion,\"usuariopropietario\")\n\t\t\t\t.populate(\"usuariopropietario\")\n\t\t\t\t.then(documentoEtiquetaCorreccion => {\n\t\t\t\t\tif(documentoEtiquetaCorreccion.usuariopropietario.correo === args.correoUsuario){\n\t\t\t\t\t\treturn models.discusionPregunta.count({etiquetas_correcciones: args.idEtiquetaCorreccion,\n\t\t\t\t\t\t\thabilitada: true})\n\t\t\t\t\t\t\t.then(numeroDiscusionesPreguntas => {\n\t\t\t\t\t\t\t\tif (numeroDiscusionesPreguntas > 0) {\n\t\t\t\t\t\t\t\t\tthrow new Error(\"you can't edit this tag, because other users are using the same tag\");\n\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\treturn models.etiquetaCorrecciones.findByIdAndRemove(args.idEtiquetaCorreccion)\n\t\t\t\t\t\t\t\t\t\t.then(etiquetaCorreccionEditada => {\n\t\t\t\t\t\t\t\t\t\t\treturn etiquetaCorreccionEditada;\n\t\t\t\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\tif (error){\n\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthrow new Error(\"you can't edit this tag because you are not the owner\");\n\t\t\t\t\t}\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t}\n\n\t}\n\n};"]}