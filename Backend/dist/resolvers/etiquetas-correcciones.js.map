{"version":3,"sources":["../../resolvers/etiquetas-correcciones.js"],"names":["Query","Mutation","crearNuevaEtiquetaCorrecciones","parent","args","models","etiquetaCorrecciones","findOne","etiqueta","$regex","RegExp","then","Error","save","documento","catch","error","editarEtiquetaCorrecciontoPregunta","findById","idEtiquetaCorreccion","populate","documentoEtiquetaCorreccion","usuariopropietario","correo","correoUsuario","discusionPregunta","count","etiquetas_correcciones","habilitada","numeroDiscusionesPreguntas","findByIdAndUpdate","$set","color","descripcion","new","etiquetaCorreccionEditada"],"mappings":";;;;;kBAAe;AACdA,QAAO,EADO;AAKdC,WAAW;AACVC,kCAAgC,wCAACC,MAAD,EAASC,IAAT,QAA4B;AAAA,OAAZC,MAAY,QAAZA,MAAY;;AAC3D,UAAOA,OAAOC,oBAAP,CAA4BC,OAA5B,CAAoC,EAACC,UAAU,EAACC,QAAQ,IAAIC,MAAJ,CAAWN,KAAKI,QAAL,CAAcA,QAAzB,EAAmC,GAAnC,CAAT,EAAX,EAApC,EACLG,IADK,CACA,oBAAY;AACjB,QAAIH,QAAJ,EAAc;AACb,WAAM,IAAII,KAAJ,CAAU,0CAAV,CAAN;AACA,KAFD,MAEK;AACJ,SAAMN,uBAAuB,IAAID,OAAOC,oBAAX,CAAgCF,KAAKI,QAArC,CAA7B;AACA,YAAOF,qBAAqBO,IAArB,GACLF,IADK,CACA,qBAAa;AAClB,aAAOG,SAAP;AACA,MAHK,EAILC,KAJK,CAIC,iBAAS;AACf,UAAIC,KAAJ,EAAW;AACV,aAAM,IAAIJ,KAAJ,CAAUI,KAAV,CAAN;AACA;AAED,MATK,CAAP;AAUA;AACD,IAjBK,EAiBHD,KAjBG,CAiBG,iBAAS;AACjB,QAAIC,KAAJ,EAAU;AACT,WAAM,IAAIJ,KAAJ,CAAUI,KAAV,CAAN;AACA;AACD,IArBK,CAAP;AAsBA,GAxBS;AAyBVC,sCAAoC,4CAACd,MAAD,EAASC,IAAT,SAA4B;AAAA,OAAZC,MAAY,SAAZA,MAAY;;AAC/D,UAAOA,OAAOC,oBAAP,CAA4BY,QAA5B,CAAqCd,KAAKe,oBAA1C,EAA+D,oBAA/D,EACLC,QADK,CACI,oBADJ,EAELT,IAFK,CAEA,uCAA+B;AACpC,QAAGU,4BAA4BC,kBAA5B,CAA+CC,MAA/C,KAA0DnB,KAAKoB,aAAlE,EAAgF;AAC/E,YAAOnB,OAAOoB,iBAAP,CAAyBC,KAAzB,CAA+B,EAACC,wBAAwBvB,KAAKe,oBAA9B;AACrCS,kBAAY,IADyB,EAA/B,EAELjB,IAFK,CAEA,sCAA8B;AACnC,UAAIkB,6BAA6B,CAAjC,EAAoC;AACnC,aAAM,IAAIjB,KAAJ,CAAU,qEAAV,CAAN;AACA,OAFD,MAEM;AACL,cAAOP,OAAOC,oBAAP,CAA4BwB,iBAA5B,CAA8C1B,KAAKe,oBAAnD,EACN,EAACY,MAAK,EAACC,OAAO5B,KAAK4B,KAAb,EAAoBC,aAAa7B,KAAK6B,WAAtC,EAAmDzB,UAAUJ,KAAKI,QAAlE,EAAN,EADM,EAEN,EAAC0B,KAAK,IAAN,EAFM,EAGLvB,IAHK,CAGA,qCAA6B;AAClC,eAAOwB,yBAAP;AACA,QALK,EAKHpB,KALG,CAKG,iBAAS;AACjB,YAAIC,KAAJ,EAAW;AACV,eAAM,IAAIJ,KAAJ,CAAUI,KAAV,CAAN;AACA;AACD,QATK,CAAP;AAWA;AACD,MAlBK,EAkBHD,KAlBG,CAkBG,iBAAS;AACjB,UAAIC,KAAJ,EAAU;AACT,aAAM,IAAIJ,KAAJ,CAAUI,KAAV,CAAN;AACA;AACD,MAtBK,CAAP;AAwBA,KAzBD,MAyBK;AACJ,WAAM,IAAIJ,KAAJ,CAAU,uDAAV,CAAN;AACA;AACD,IA/BK,EA+BHG,KA/BG,CA+BG,iBAAS;AACjB,QAAIC,KAAJ,EAAW;AACV,WAAM,IAAIJ,KAAJ,CAAUI,KAAV,CAAN;AACA;AACD,IAnCK,CAAP;AAoCA;;AA9DS;;AALG,C","file":"etiquetas-correcciones.js","sourcesContent":["export default {\n\tQuery: {\n\n\n\t},\n\tMutation : {\n\t\tcrearNuevaEtiquetaCorrecciones: (parent, args, {models}) => {\n\t\t\treturn models.etiquetaCorrecciones.findOne({etiqueta: {$regex: new RegExp(args.etiqueta.etiqueta, \"i\")}})\n\t\t\t\t.then(etiqueta => {\n\t\t\t\t\tif (etiqueta) {\n\t\t\t\t\t\tthrow new Error(\"this tag already exist in the collection\");\n\t\t\t\t\t}else{\n\t\t\t\t\t\tconst etiquetaCorrecciones = new models.etiquetaCorrecciones(args.etiqueta);\n\t\t\t\t\t\treturn etiquetaCorrecciones.save()\n\t\t\t\t\t\t\t.then(documento => {\n\t\t\t\t\t\t\t\treturn documento;\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error){\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t\teditarEtiquetaCorrecciontoPregunta: (parent, args, {models}) => {\n\t\t\treturn models.etiquetaCorrecciones.findById(args.idEtiquetaCorreccion,\"usuariopropietario\")\n\t\t\t\t.populate(\"usuariopropietario\")\n\t\t\t\t.then(documentoEtiquetaCorreccion => {\n\t\t\t\t\tif(documentoEtiquetaCorreccion.usuariopropietario.correo === args.correoUsuario){\n\t\t\t\t\t\treturn models.discusionPregunta.count({etiquetas_correcciones: args.idEtiquetaCorreccion,\n\t\t\t\t\t\t\thabilitada: true})\n\t\t\t\t\t\t\t.then(numeroDiscusionesPreguntas => {\n\t\t\t\t\t\t\t\tif (numeroDiscusionesPreguntas > 0) {\n\t\t\t\t\t\t\t\t\tthrow new Error(\"you can't edit this tag, because other users are using the same tag\");\n\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\treturn models.etiquetaCorrecciones.findByIdAndUpdate(args.idEtiquetaCorreccion,\n\t\t\t\t\t\t\t\t\t\t{$set:{color: args.color, descripcion: args.descripcion, etiqueta: args.etiqueta}},\n\t\t\t\t\t\t\t\t\t\t{new: true})\n\t\t\t\t\t\t\t\t\t\t.then(etiquetaCorreccionEditada => {\n\t\t\t\t\t\t\t\t\t\t\treturn etiquetaCorreccionEditada;\n\t\t\t\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\t\t\tif (error){\n\t\t\t\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthrow new Error(\"you can't edit this tag because you are not the owner\");\n\t\t\t\t\t}\n\t\t\t\t}).catch(error => {\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tthrow new Error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t}\n\n\t}\n\n};"]}